
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RDS F√°cil - CSS Construtora</title>
  <link rel="manifest" href="manifest.json">
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js')
          .then(reg => console.log('Service Worker registrado:', reg))
          .catch(err => console.log('Service Worker erro:', err));
      });
    }
  </script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
    .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .logo { height: 80px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; }
    th, td { border: 1px solid #000; padding: 8px; text-align: center; }
    th { background-color: #004aad; color: white; }
    input, select { margin: 4px; padding: 6px; }
    label { display: inline-block; margin-right: 10px; }
    .form-section { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
  </style>
</head>
<body>

<div class="top-bar">
  <img src="logo-css.png" alt="Logo CSS" class="logo">
  <div>
    <label>Data: <input type="date" id="data"></label><br>
    <label>Dia da semana: <input type="text" id="dia_semana" readonly></label>
  </div>
</div>

<h1>Relat√≥rio Di√°rio de Servi√ßo - CSS Construtora</h1>

<div class="form-section">
<form id="form-colab">
  <label>Setor: <input type="text" id="setor" required></label><br>
  <label>Nome: <input type="text" id="nome" required></label>
  <label>C√≥digo: <input type="text" id="codigo" required></label>
  <label>Matr√≠cula: <input type="text" id="matricula" required></label>
  <label>Fun√ß√£o: <input type="text" id="funcao"></label><br>
  <label>Turno:
    <select id="turno">
      <option>Manh√£</option>
      <option>Tarde</option>
      <option>Noite</option>
    </select>
  </label>
  <label>Entrada: <input type="time" id="entrada"></label>
  <label>Intervalo: <input type="text" id="intervalo" value="12:00 √†s 13:00"></label>
  <label>Sa√≠da: <input type="time" id="saida"></label><br>
  <label>Local de trabalho: <input type="text" id="local"></label>
  <label>Condi√ß√µes do tempo:
    <select id="tempo">
      <option>Bom</option>
      <option>Chuva</option>
      <option>Impratic√°vel</option>
    </select>
  </label><br>
  <label>Atividade executada: <input type="text" id="atividade"></label>
  <label>Situa√ß√£o do servi√ßo:
    <select id="situacao">
      <option>Em andamento</option>
      <option>Finalizado</option>
      <option>Impratic√°vel</option>
    </select>
  </label>
  <label>Ve√≠culo utilizado: <input type="text" id="veiculo"></label><br>
  <label><input type="checkbox" id="assinatura"> Assinatura digital</label>
  <button type="submit">Adicionar</button>
</form>
</div>

<table id="tabela">
  <thead>
    <tr>
      <th>Nome</th><th>C√≥digo</th><th>Matr√≠cula</th><th>Fun√ß√£o</th>
      <th>Turno</th><th>Entrada</th><th>Intervalo</th><th>Sa√≠da</th>
      <th>Local</th><th>Tempo</th><th>Atividade</th><th>Situa√ß√£o</th><th>Ve√≠culo</th><th>Assinatura</th>
    </tr>
  </thead>
  <tbody></tbody>

</table>

<div style="margin-top: 20px;">
  <button onclick="window.print()">üñ®Ô∏è Imprimir / Salvar como PDF</button>
  <button onclick="limparTabela()">üßπ Limpar Tabela</button>
  <button onclick="exportarJSON()">üì¶ Exportar JSON</button>
</div>

<script>
  function limparTabela() {
    const tbody = document.querySelector("#tabela tbody");
    tbody.innerHTML = "";
  }

  function exportarJSON() {
    const rows = Array.from(document.querySelectorAll("#tabela tbody tr"));
    const dados = rows.map(row => {
      const cells = Array.from(row.querySelectorAll("td"));
      return {
        nome: cells[0].innerText,
        codigo: cells[1].innerText,
        matricula: cells[2].innerText,
        funcao: cells[3].innerText,
        turno: cells[4].innerText,
        entrada: cells[5].innerText,
        intervalo: cells[6].innerText,
        saida: cells[7].innerText,
        local: cells[8].innerText,
        tempo: cells[9].innerText,
        atividade: cells[10].innerText,
        situacao: cells[11].innerText,
        veiculo: cells[12].innerText,
        assinatura: cells[13].innerText
      };
    });
    const blob = new Blob([JSON.stringify(dados, null, 2)], {type: "application/json"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "rds-dados.json";
    a.click();
    URL.revokeObjectURL(url);
  }
</script>


<script>
  document.getElementById("form-colab").addEventListener("submit", function(e) {
    e.preventDefault();
    const get = id => document.getElementById(id).value;
    const assinatura = document.getElementById("assinatura").checked ? "‚úîÔ∏è" : "";
    const tbody = document.querySelector("#tabela tbody");
    // Valida√ß√£o de matr√≠cula duplicada
    const matricula = get("matricula");
    let duplicado = false;
    Array.from(tbody.rows).forEach(row => {
      if (row.cells[2].innerText === matricula) duplicado = true;
    });
    if (duplicado) {
      alert("Matr√≠cula j√° cadastrada!");
      return;
    }
    const row = document.createElement("tr");
    row.innerHTML = `<td>${get("nome")}</td><td>${get("codigo")}</td><td>${get("matricula")}</td>
                     <td>${get("funcao")}</td><td>${get("turno")}</td><td>${get("entrada")}</td>
                     <td>${get("intervalo")}</td><td>${get("saida")}</td><td>${get("local")}</td>
                     <td>${get("tempo")}</td><td>${get("atividade")}</td><td>${get("situacao")}</td>
                     <td>${get("veiculo")}</td><td>${assinatura}</td>`;
    // Bot√£o de remover
    const btnRemover = document.createElement("button");
    btnRemover.textContent = "Remover";
    btnRemover.onclick = function() {
      if (confirm("Deseja remover este colaborador?")) {
        tbody.removeChild(row);
      }
    };
    row.appendChild(document.createElement("td")).appendChild(btnRemover);
    tbody.appendChild(row);
    this.reset();
  });

  document.getElementById("data").addEventListener("change", function() {
    const dias = ["Domingo", "Segunda-feira", "Ter√ßa-feira", "Quarta-feira", "Quinta-feira", "Sexta-feira", "S√°bado"];
    const data = new Date(this.value);
    document.getElementById("dia_semana").value = dias[data.getDay()];
  });
</script>

</body>
</html>
